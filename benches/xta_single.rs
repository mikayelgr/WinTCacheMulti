// TODO: Implement the single-threaded version
